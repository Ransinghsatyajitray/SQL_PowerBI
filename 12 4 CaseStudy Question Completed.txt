-- Q1:	HOW TO REPORT YEAR WISE TOTAL SALES?
-- Q2:  HOW TO REPORT YEAR WISE, QUARTER WISE TOTAL SALES AND TOTAL TAX?
-- Q3:  HOW TO REPORT YEAR WISE, QUARTER WISE, MONTH WISE TOTAL SALES AND TOTAL TAX?
-- Q4:  HOW TO REPORT YEAR WISE, QUARTER WISE TOTAL SALES AND TOTAL TAX FOR JUNE MONTH ?
-- Q5:  HOW TO REPORT CLASS WISE, COLOR WISE PRODUCTS FOR EACH YEAR BASED ON ASC ORDER OF SALES?
-- Q6: HOW TO REPORT TOTAL SALES FOR SUCH PRODUCTS WITH MAXIMUM NUMBER OF SALES?
-- Q7: HOW TO REPORT TOTAL SALES FOR SUCH PRODUCTS EXCEPT WITH MINIMUM NUMBER OF SALES?
-- Q8: HOW TO COMBINE THE RESULTS FROM ABOVE TWO QUERIES.
-- Q9: HOW TO ADDRESS POSSIBLE BLOCKING ISSUES FROM ABOVE TWO QUERIES?
-- Q10: HOW TO REPORT YEAR WISE, CUSTOMER WISE, PRODUCT WISE TOTAL SALES AND TOTAL TAX ABOVE 1000 USD?

SELECT * FROM CUSTOMERS_DATA
SELECT * FROM PRODUCTS_DATA
SELECT * FROM TIME_DATA
SELECT * FROM SALES_DATA


-- Q1:	HOW TO REPORT YEAR WISE TOTAL SALES?
SELECT CalendarYear, SUM(SalesAmount) AS Total_Sales_Year
FROM TIME_DATA
INNER JOIN
SALES_DATA
ON TIME_DATA.TimeKey=SALES_DATA.ShipDateKey
INNER JOIN
GROUP BY CalendarYear


-- Q2:  HOW TO REPORT YEAR WISE, QUARTER WISE TOTAL SALES AND TOTAL TAX?
SELECT CalendarYear, CalendarQuarter, SUM(TaxAmt) AS Total_Quarterly_Tax
FROM TIME_DATA
INNER JOIN
SALES_DATA
ON TIME_DATA.TimeKey=SALES_DATA.ShipDateKey
GROUP BY CalendarYear,CalendarQuarter


-- Q3:  HOW TO REPORT YEAR WISE, QUARTER WISE, MONTH WISE TOTAL SALES AND TOTAL TAX?
SELECT CalendarYear, CalendarQuarter, EnglishMonthName, SUM(TaxAmt) AS Total_Quarterly_Tax
FROM TIME_DATA
INNER JOIN
SALES_DATA
ON TIME_DATA.TimeKey=SALES_DATA.ShipDateKey
GROUP BY CalendarYear,CalendarQuarter,EnglishMonthName

-- Q5:  HOW TO REPORT CLASS WISE, COLOR WISE PRODUCTS FOR EACH YEAR BASED ON ASC ORDER OF SALES?
SELECT Class,Color,CalendarYear,SUM(SalesAmount) AS Class_Color_Total_Sales
FROM PRODUCTS_DATA
INNER JOIN
SALES_DATA
ON PRODUCTS_DATA.ProductKey=SALES_DATA.ProductKey
INNER JOIN
TIME_DATA
ON SALES_DATA.ShipDateKey=TIME_DATA.TimeKey
GROUP BY Class,Color,CalendarYear
ORDER BY SUM(SalesAmount) ASC


-- Q6: HOW TO REPORT TOTAL SALES FOR SUCH PRODUCTS WITH MAXIMUM NUMBER OF SALES? --DIDN'T DO IT ON MY OWN SAW YOUR NOTES


CREATE VIEW VW_SALE_PROIDUCTS 
AS
SELECT P.EnglishProductName,SUM(S.SalesAmount) AS TOTAL_SALES
FROM SALES_DATA  AS S
INNER JOIN PRODUCTS_DATA AS P
ON
P.ProductKey = S.ProductKey
GROUP BY P.EnglishProductName



SELECT EnglishProductName FROM VW_SALE_PROIDUCTS 
				WHERE TOTAL_SALES = (SELECT MAX(TOTAL_SALES) FROM VW_SALE_PROIDUCTS)


-- Q7: HOW TO REPORT TOTAL SALES FOR SUCH PRODUCTS EXCEPT WITH MINIMUM NUMBER OF SALES?
CREATE VIEW VW_SALE_MIN_SALE
AS
SELECT P.EnglishProductName,SUM(S.SalesAmount) AS TOTAL_SALES
FROM SALES_DATA  AS S
INNER JOIN PRODUCTS_DATA AS P
ON
P.ProductKey = S.ProductKey
GROUP BY P.EnglishProductName

SELECT EnglishProductName FROM VW_SALE_PROIDUCTS 
				WHERE TOTAL_SALES > (SELECT MIN(TOTAL_SALES) FROM VW_SALE_PROIDUCTS)

-- Q8: HOW TO COMBINE THE RESULTS FROM ABOVE TWO QUERIES.
SELECT EnglishProductName FROM VW_SALE_PROIDUCTS 
				WHERE TOTAL_SALES > (SELECT MIN(TOTAL_SALES) FROM VW_SALE_PROIDUCTS) OR
				TOTAL_SALES = (SELECT MAX(TOTAL_SALES) FROM VW_SALE_PROIDUCTS)
	
	

-- Q9: HOW TO ADDRESS POSSIBLE BLOCKING ISSUES FROM ABOVE TWO QUERIES?
SELECT EnglishProductName FROM VW_SALE_PROIDUCTS 
				WHERE TOTAL_SALES NOT IN (SELECT MIN(TOTAL_SALES) FROM VW_SALE_PROIDUCTS) OR
				TOTAL_SALES NOT IN (SELECT MAX(TOTAL_SALES) FROM VW_SALE_PROIDUCTS)


-- Q10: HOW TO REPORT YEAR WISE, CUSTOMER WISE, PRODUCT WISE TOTAL SALES AND TOTAL TAX ABOVE 1000 USD?
--DIDN'T DO IT ON MY OWN SAW YOUR NOTES FOR  FirstName + '  ' + LastName AS FULLNAME


SELECT CalendarYear, FirstName + '  ' + LastName AS FULLNAME,EnglishProductName, SUM(SalesAmount) AS Total_Sale_Amount, SUM(TaxAmt) AS Total_Tax
FROM TIME_DATA
INNER JOIN
SALES_DATA
ON TIME_DATA.TimeKey=SALES_DATA.ShipDateKey
INNER JOIN
CUSTOMERS_DATA
ON SALES_DATA.CustomerKey=CUSTOMERS_DATA.CustomerKey
INNER JOIN
PRODUCTS_DATA
ON SALES_DATA.ProductKey=PRODUCTS_DATA.ProductKey
GROUP BY CalendarYear, FirstName + '  ' + LastName,EnglishProductName
HAVING SUM(SalesAmount)>1000